{% extends 'ludotec_app/home.html' %}
{% load static %}

{% block section %}
{% include 'ludotec_app/mensajes.html' %}
<div class="d-flex justify-content-center mt-5">
    <h3 class="mb-4 mt-3">Registra una nueva partida</h3>
</div>
<div class="container">
    <div class="row justify-content-center">
        <div class="col-md-6">
            <div>
                <form method="post" class="form-style">
                    {% csrf_token %}
                    <div class="row mb-3">
                        <div class="col-md-6">
                            <label for="id_juego">Mis juegos:</label>
                            {{ form.juego }}<br><br>
                            <label for="id_juego_externo">Juego nuevo:</label>
                            <input type="text" id="id_juego_externo" name="juego_externo" class="form-control"><br><br>
                            <label for="id_duracion">Duración:</label>
                            {{ form.duracion }}<br><br>
                            <label for="id_lugar">Lugar:</label>
                            {{ form.lugar }}<br><br>
                        </div>

                        <div class="col-md-6">
                            <label for="id_fecha">Fecha:</label>
                            {{ form.fecha }}<br><br>
                            <label for="id_ganador">Ganador:</label>
                            {{ form.ganador }}<br><br> <!-- Renderizando el campo ganador -->
                            <details>
                                <summary>Agregar jugadores</summary>
                                <fieldset class="border border-secondary rounded p-2">
                                    <label for="id_nombre_jugador">Nombre jugador:</label>
                                    <input type="text" id="id_nombre_jugador" class="form-control" name="nombre_jugador">
                                    <label for="id_puntuacion" class="mt-5">Puntuación:</label>
                                    <input type="number" id="id_puntuacion" class="form-control" name="puntuacion">
                                    <div class="text-center mt-3">
                                        <button type="button" id="guardar-jugador-puntuacion" class="btn btn-secondary btn-sm">Agregar jugador</button>
                                    </div>
                                </fieldset>
                            </details>
                            <div style="display: none;">
                                <label for="id_jugadores" class="display:none;">Nombre jugador:</label>
                                {{ form.jugadores }}
                            </div>
                            <div>
                                <input type="hidden" id="id_puntuaciones" name="puntuaciones" value="">
                            </div>

                        </div>
                    </div>

                    <!-- Campos ocultos para almacenar los nombres de los jugadores y sus puntuaciones -->

                    <button type="submit" class="btn btn-primary d-block mx-auto mt-5">Guardar partida</button>
                    <div class="row justify-content-center mt-3">
                        <div class="col-md-12 text-center">
                            <button type="button" onclick="window.history.back()" class="btn btn-secondary btn-sm">Volver</button>
                        </div>
                    </div>
                </form>
            </div>

            <br><br>
            <div id="puntuacion-container">
                <!-- Contenedor para la tabla de puntuaciones -->
                <table id="puntuacion-table">
                    <thead id="puntuacion-table-head" style="display: none;">
                        <tr>
                            <th>Nombre jugador</th>
                            <th>Puntuación</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Aquí se añadirán las filas dinámicamente -->
                    </tbody>
                </table>
            </div>

        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
<script src="{% static 'ludotec_app/js/register.js' %}"></script>

{% endblock %}